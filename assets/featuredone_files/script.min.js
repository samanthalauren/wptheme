(function(e){"use strict";window.jpibfi=function(){function a(e){var t=jQuery("<div/>",{"class":"image-caption","imgcaption-indexer":e});return t}function f(t,n){var r=jQuery("<a/>",{href:"#",onclick:n,"class":"pinit-button","data-jpibfi-indexer":t,text:""});r.click(function(t){p("Pin In button clicked");var n=e(this).data("jpibfi-indexer");var r=e('img[data-jpibfi-indexer="'+n+'"]');var i="",s="",o="";if(u.settings.usePostUrl){var a=r.closest(".jpibfi_container").find("input.jpibfi").first();if(a.length){s=a.data("jpibfi-description");o=a.data("jpibfi-url")}}o=o||u.settings.pageUrl;if(u.settings.descriptionOption==3)i=r.attr("title")||r.attr("alt");else if(u.settings.descriptionOption==2)i=s||u.settings.pageDescription;else if(u.settings.descriptionOption==4)i=u.settings.siteTitle;else if(u.settings.descriptionOption==5)i=r.data("jpibfi-description");else if(u.settings.descriptionOption==6)i=r.attr("alt");i=i||s||u.settings.pageTitle;var f="http://pinterest.com/pin/create/bookmarklet/?is_video="+encodeURIComponent("false")+"&url="+encodeURIComponent(o)+"&media="+encodeURIComponent(u.fn.getImageUrl(r))+"&description="+encodeURIComponent(i);window.open(f,"Pinterest","width=632,height=253,status=0,toolbar=0,menubar=0,location=1,scrollbars=1");return false});return r}function l(e){if(e[0].clientWidth<u.settings.minImageWidth||e[0].clientHeight<u.settings.minImageHeight)return false;return true}function c(e){switch(e){case"0":return"pinit-top-left";case"1":return"pinit-top-right";case"2":return"pinit-bottom-left";case"3":return"pinit-bottom-right";case"4":return"pinit-middle";default:return""}}function h(e){var t=e.split(";");var n="";for(var r=0;r<t.length;r++){if(t[r])n+="."+t[r]+","}if(n)n=n.substr(0,n.length-1);return n}function p(e){if(t&&console&&console.log){if("string"==typeof e||e instanceof String){console.log("jpibfi debug: "+e)}else if("object"==typeof e&&typeof JSON!=="undefined"&&typeof JSON.stringify==="function"){console.log("jpibfi debug: "+JSON.stringify(e,null,4))}else if("object"==typeof e){var n="";for(var r in e)n+=r+": "+e[r]+"\n";console.log("jpibfi debug: "+n)}}}var t=false;var n={};var r={};var i="";var s="*";var o=0;var u={};u.settings={};u.fn={};u.fn.getImageUrl=function(t){return e.fn.prop&&t.prop("src")||t.attr("src")};u.addImages=function(t){p(">>addImages");var n=e(t).not(i).not("[data-jpibfi-indexer]").filter(s);n.each(function(){var t;var n={width:e(this).get(0).clientWidth,height:e(this).get(0).clientHeight};var r=u.fn.getImageUrl(e(this));e(this).attr("data-jpibfi-indexer",o);t=e(this).offset();e(this).wrap('<div class="imagewrapper" data-jpibfi-indexer="'+o+'" src="'+u.fn.getImageUrl(e(this))+'" ></div>');o++});p("Images caught by selectors: "+o);return n};u.prepareImages=function(e){p(">>Add Elements");p("Elements: "+e.length);p("Min width:"+u.settings.minImageWidth);p("Min height:"+u.settings.minImageHeight);var t=0;e.each(function(){t++});p("Images caught after filtering: "+t)};u.removeAllImages=function(){p("Remove Elements called");e("div.pinit-overlay").remove()};u.init=function(o){u.settings={pageUrl:document.URL,pageTitle:document.title,pageDescription:e('meta[name="description"]').attr("content")||""};u.settings=e.extend(u.settings,o);n={height:parseInt(o.pinImageHeight),width:parseInt(o.pinImageWidth)};if(u.settings.retinaFriendly==1){n.height=n.height/2;n.width=n.width/2}r={top:parseInt(o.buttonMarginTop),right:parseInt(o.buttonMarginRight),bottom:parseInt(o.buttonMarginBottom),left:parseInt(o.buttonMarginLeft)};t="1"==o.debug;p(u.settings);p(n);p(r);var c=e(".jpibfi").closest(u.settings.containerSelector).addClass("jpibfi_container");p("Number of containers added: "+c.length);i=h(u.settings.disabledClasses);s=h(u.settings.enabledClasses)||"*";p("Filter selector: "+s);p("Not selector: "+i);e(document).delegate("a.pinit-button","mouseenter",function(){var t=e(this);clearTimeout(t.data("jpibfi-timeoutId"))});e(document).delegate("a.pinit-button","mouseleave",function(){var t=e(this);var n=setTimeout(function(){t.remove();e('img[data-jpibfi-indexer="'+t.data("jpibfi-indexer")+'"]').removeClass("pinit-hover")},100);t.data("jpibfi-timeoutId",n)});e(document).delegate("div[data-jpibfi-indexer]","mouseenter",function(){var t=e(this);if(l(t)==false){t.removeAttr("data-jpibfi-indexer");return}var i=t.data("jpibfi-indexer");var s=e('a.pinit-button[data-jpibfi-indexer="'+i+'"]');var o=e('div.image-caption[imgcaption-indexer="'+i+'"]');var c=u.fn.getImageUrl(t);if(s.length==0){s=f(i,"ga('send','event','Image_Social_Share','Pinterest','"+c+"');");var h=t.offset();var p=t.offset();var d={width:t.get(0).clientWidth,height:t.get(0).clientHeight};switch(u.settings.buttonPosition){case"0":p.left+=r.left;p.top+=r.top;break;case"1":p.top+=r.top;p.left=p.left+d.width-r.right-n.width;break;case"2":p.left+=r.left;p.top=p.top+d.height-r.bottom-n.height;break;case"3":p.left=p.left+d.width-r.right-n.width;p.top=p.top+d.height-r.bottom-n.height;break;case"4":p.left=Math.round(p.left+d.width/2-n.width/2);p.top=Math.round(p.top+d.height/2-n.height/2);break}o=a(i,d.height,d.width);t.append(o);o.height(d.height);o.width(d.width);o.fadeIn().offset({left:h.left,top:h.top});t.after(s);s.fadeIn().offset({left:p.left,top:p.top})}else{clearTimeout(s.data("jpibfi-timeoutId"))}t.addClass("pinit-hover")});e(document).delegate("div[data-jpibfi-indexer]","mouseleave",function(){var t=e(this).data("jpibfi-indexer");var n=e('a.pinit-button[data-jpibfi-indexer="'+t+'"]');var r=e('div.image-caption[imgcaption-indexer="'+t+'"]');var i=setTimeout(function(){n.fadeOut(function(){e(this).remove()});r.fadeOut(function(){e(this).remove()});e('img[data-jpibfi-indexer="'+n.data("jpibfi-indexer")+'"]').removeClass("pinit-hover")},100);n.data("jpibfi-timeoutId",i)})};return u;}()})(jQuery);(function(e){"use strict";e(document).ready(function(){jpibfi.init(jpibfi_options);e(document).trigger("jpibfi_beforeAddImages",{});jpibfi.addImages(jpibfi_options.imageSelector);e(document).trigger("jpibfi_afterAddImages",{});e(window).load(function(){jpibfi.prepareImages(e("img[data-jpibfi-indexer]"))});e(window).resize(function(){jpibfi.removeAllImages();jpibfi.prepareImages(e("img[data-jpibfi-indexer]"))})})})(jQuery)